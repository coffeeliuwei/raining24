<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <title>课程管理</title>
  <link rel="stylesheet" href="assets/style.css">
</head>
<body>
<header>
  <nav>
    <a href="/index.html">首页</a>
    <a href="/students.html">学生管理</a>
    <a href="/courses.html">课程管理</a>
    <a href="/enroll.html">选课管理</a>
  </nav>
</header>
<main>
  <h2>课程列表</h2>
  <table class="table">
    <thead><tr><th>课程名</th><th>URL</th></tr></thead>
    <tbody id="rows"></tbody>
  </table>

  <div class="card">
    <h3>新增课程</h3>
    <div id="form-course">
      <div class="form-row"><label>课程名</label><br><input name="name" /></div>
      <div class="form-row"><label>URL</label><br><input name="url" /></div>
      <button class="btn" id="btn-add">添加</button>
    </div>
  </div>
</main>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="/ext/lwquery.js"></script>
<script src="assets/miniquery.js"></script>
<script>
function load(){
  $.ajax({url:'/api/courses', method:'GET'}).then(function(resp){
    var list = (resp&&resp.data) || [];
    var tpl = '<tr><td>{{name}}</td><td>{{url}}</td></tr>';
    $.html(document.querySelector('#rows'), $.renderList(tpl, list));
  });
}
$.on(document.querySelector('#btn-add'), 'click', function(){
  var data = $.form('#form-course').get();
  LW.rest('/api/courses', data, function(){ load(); });
});
load();
</script>
</body>
</html>